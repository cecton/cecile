#!/usr/bin/env perl

use strict;
use warnings;
use utf8;

use Digest::SHA qw/sha1/;
use MIME::Base64 qw/encode_base64/;

my @symbols = (
	'!', '?', '+', '-', '=', '*', '/', '@', '#', '$', '%', '&', '(', ')', '[',
	']', ';', ':', ',', '.', '<', '>');

sub genpass
{
	my($pwd, $site) = @_;
	my $fin = encode_base64 sha1 "_${pwd}_${site}_";
	chr(ord('A') + ord(substr($fin, 0, 1)) % 26) .
	chr(ord('a') + ord(substr($fin, 1, 1)) % 26) .
	chr(ord('0') + ord(substr($fin, 2, 1)) % 10) .
	@symbols[ord(substr($fin, 3, 1)) % @symbols] .
	substr($fin, 4, 22)
}

$| = 1;

print "Password: "; chop(my $pwd = <STDIN>);
print "Site: "; chop(my $site = <STDIN>);


print
	"Hint: " . substr(genpass($pwd, "foo"), 0, 6) . "\n" .
	genpass($pwd, $site) . "\n";
