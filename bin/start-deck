#!/bin/sh

CONTAINER=steamdeck

sudo machinectl start $CONTAINER
sleep 2

DISPLAY=:`fgconsole`
VT=vt`fgconsole`

Xorg $DISPLAY $VT &
XORG_PID=$!

sudo machinectl shell -E DISPLAY=$DISPLAY -E XDG_RUNTIME_DIR="/run/user/1000" -E LIBGL_ALWAYS_SOFTWARE=1 -E GALLIUM_DRIVER=llvmpipe cecile@$CONTAINER /home/cecile/bin/i3-session

kill $XORG_PID
wait $XORG_PID
